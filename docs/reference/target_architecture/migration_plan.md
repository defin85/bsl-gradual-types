# План миграции к целевой архитектуре

Цель — включать новые слои постепенно, сохранив работоспособность текущих бинарей и API.

## Стратегия
1) Strangler‑pattern: новые сервисы живут рядом и перехватывают вызовы по мере готовности
2) Фича‑флаги/конфигурация: использовались на этапе миграции; в текущей версии отключены
3) Метрики и трейсинг: сравнивать ответы/латентность со старой реализацией

## Режим работы (актуально)
- Переключатель legacy/target удалён; все компоненты работают в target‑режиме.

## Порядок шагов
1. Завести центральную систему в `src/target/system` и инициализацию с пустыми заглушками
2. Подключить репозиторий и загрузку платформенных типов
3. Включить минимальный `TypeResolutionService` (Platform/Builtin)
4. Проксировать hover/completion LSP через новый сервис для безопасного поднабора кейсов
5. Расширять покрытие резолверов и источников, увеличивая долю трафика

## Риски и митигация
- Различия в данных: синхронизация индексов и корректные заглушки в target без fallback на legacy
- Производительность: поэтапное включение, профилирование на реальных проектах
- Совместимость: API интерфейсов неизменны, меняется только реализация
