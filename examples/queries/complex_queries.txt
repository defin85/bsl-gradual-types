// Примеры сложных запросов с JOIN, GROUP BY, временными таблицами

// 1. Запрос с LEFT JOIN
ВЫБРАТЬ
    Док.Номер КАК НомерДокумента,
    Док.Дата КАК ДатаДокумента,
    Контр.Наименование КАК НазваниеКонтрагента,
    Контр.ИНН
ИЗ
    Документ.ПоступлениеТоваровУслуг КАК Док
    ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Контрагенты КАК Контр
    ПО Док.Контрагент = Контр.Ссылка
ГДЕ
    Док.Проведен = ИСТИНА

// 2. Запрос с GROUP BY и агрегатными функциями
ВЫБРАТЬ
    Контрагент,
    СУММА(СуммаДокумента) КАК ОбщаяСумма,
    КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Номер) КАК КоличествоДокументов,
    СРЕДНЕЕ(СуммаДокумента) КАК СредняяСумма
ИЗ
    Документ.ПоступлениеТоваровУслуг
ГДЕ
    Проведен = ИСТИНА
СГРУППИРОВАТЬ ПО
    Контрагент
ИМЕЮЩИЕ
    СУММА(СуммаДокумента) > 100000
УПОРЯДОЧИТЬ ПО
    ОбщаяСумма УБЫВ

// 3. Запрос с временными таблицами
ВЫБРАТЬ
    Товар.Ссылка КАК Номенклатура,
    Товар.Наименование,
    Товар.Артикул
ПОМЕСТИТЬ ВТ_Товары
ИЗ
    Справочник.Номенклатура КАК Товар
ГДЕ
    НЕ Товар.ЭтоГруппа
    И Товар.ВидНоменклатуры = &ВидНоменклатуры;

ВЫБРАТЬ
    Товары.Наименование,
    Товары.Артикул,
    Остатки.КоличествоОстаток,
    Остатки.Склад.Наименование КАК НазваниеСклада
ИЗ
    ВТ_Товары КАК Товары
    ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки(&КонецПериода) КАК Остатки
    ПО Товары.Номенклатура = Остатки.Номенклатура
УПОРЯДОЧИТЬ ПО
    Товары.Наименование,
    НазваниеСклада

// 4. Запрос с CASE выражением
ВЫБРАТЬ
    Номер,
    Дата,
    СуммаДокумента,
    ВЫБОР
        КОГДА СуммаДокумента < 10000 ТОГДА "Малая"
        КОГДА СуммаДокумента < 100000 ТОГДА "Средняя"
        КОГДА СуммаДокумента < 1000000 ТОГДА "Крупная"
        ИНАЧЕ "Особо крупная"
    КОНЕЦ КАК КатегорияСуммы
ИЗ
    Документ.ПоступлениеТоваровУслуг

// 5. Запрос с UNION
ВЫБРАТЬ
    Номер,
    Дата,
    "Поступление" КАК ТипДокумента,
    СуммаДокумента
ИЗ
    Документ.ПоступлениеТоваровУслуг

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
    Номер,
    Дата,
    "Реализация",
    СуммаДокумента
ИЗ
    Документ.РеализацияТоваровУслуг

УПОРЯДОЧИТЬ ПО
    Дата УБЫВ