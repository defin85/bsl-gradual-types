# BSL Gradual Type System

ะกะพะฒัะตะผะตะฝะฝะฐั ัะธััะตะผะฐ ะณัะฐะดัะฐะปัะฝะพะน ัะธะฟะธะทะฐัะธะธ ะดะปั ัะทัะบะฐ 1ะก:ะัะตะดะฟัะธััะธะต BSL, ะพะฑัะตะดะธะฝัััะฐั ััะฐัะธัะตัะบะธะน ะฐะฝะฐะปะธะท ั runtime ะบะพะฝััะฐะบัะฐะผะธ.

## ๐ฏ ะะปััะตะฒัะต ะฒะพะทะผะพะถะฝะพััะธ

- **ะัะฐะดัะฐะปัะฝะฐั ัะธะฟะธะทะฐัะธั** - ะะปะฐะฒะฝัะน ะฟะตัะตัะพะด ะพั ะดะธะฝะฐะผะธัะตัะบะพะน ะบ ััะฐัะธัะตัะบะพะน ัะธะฟะธะทะฐัะธะธ
- **ะญะฒะพะปััะธะพะฝะฝะฐั ะฐััะธัะตะบัััะฐ** - ะะฐัะธะฝะฐะตะผ ั MVP, ัะฐััะธััะตะผ ะฑะตะท breaking changes
- **Pipeline ัะฐะทัะตัะตะฝะธั ัะธะฟะพะฒ** - ะฃัะพะฒะฝะธ ัะฒะตัะตะฝะฝะพััะธ ั ะผะฝะพะถะตััะฒะตะฝะฝัะผะธ ะธััะพัะฝะธะบะฐะผะธ
- **ะคะฐัะตัะฝะฐั ัะธััะตะผะฐ** - ะะพะดะดะตัะถะบะฐ ัะฐะทะฝัั ะฟัะตะดััะฐะฒะปะตะฝะธะน ะพะดะฝะพะณะพ ัะธะฟะฐ
- **Runtime ะบะพะฝััะฐะบัั** - ะะธะฝะฐะผะธัะตัะบะฐั ะฟัะพะฒะตัะบะฐ ัะธะฟะพะฒ ะดะปั ะฝะตะพะฟัะตะดะตะปัะฝะฝัั ัะปััะฐะตะฒ
- **ะะฐััะตั ะทะฐะฟัะพัะพะฒ 1ะก** - ะะพะปะฝะฐั ะฟะพะดะดะตัะถะบะฐ ัะทัะบะฐ ะทะฐะฟัะพัะพะฒ ั ะฒัะตะผะตะฝะฝัะผะธ ัะฐะฑะปะธัะฐะผะธ

## ๐ ะัััััะน ััะฐัั

```bash
# ะกะฑะพัะบะฐ ะฟัะพะตะบัะฐ
cargo build --release

# ะะฝะฐะปะธะท BSL ัะฐะนะปะฐ
cargo run --bin bsl-analyzer -- --file module.bsl

# ะะฐะฟััะบ LSP ัะตัะฒะตัะฐ
cargo run --bin lsp-server

# ะัะพะฒะตัะบะฐ ัะธะฟะพะฒ
cargo run --bin type-check -- --file module.bsl

# ะะตะผะพะฝัััะฐัะธั ะฟะฐััะตัะฐ ะทะฐะฟัะพัะพะฒ
cargo run --example query_demo
```

## ๐ ะะฑะทะพั ะฐััะธัะตะบัััั

ะกะธััะตะผะฐ ะฟะพัััะพะตะฝะฐ ะฝะฐ ัะปะพะธััะพะน ะฐััะธัะตะบัััะต, ะฟะพะทะฒะพะปัััะตะน ะธะฝะบัะตะผะตะฝัะฐะปัะฝัั ัะฐะทัะฐะฑะพัะบั:

### ะะปััะตะฒัะต ะบะพะฝัะตะฟัะธะธ

1. **TypeResolution** - ะะต ัะธะฟ, ะฐ ัะฐะทัะตัะตะฝะธะต ั ััะพะฒะฝะตะผ ัะฒะตัะตะฝะฝะพััะธ
2. **ะฃัะพะฒะฝะธ ัะฒะตัะตะฝะฝะพััะธ** - Known, Inferred(0.0-1.0), Unknown
3. **ะคะฐัะตัั** - ะะฝะพะถะตััะฒะตะฝะฝัะต ะฟัะตะดััะฐะฒะปะตะฝะธั ัะธะฟะฐ (Manager, Object, Reference, Metadata)
4. **ะัะฐะดัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั** - ะกัะฐัะธัะตัะบะธะน ัะธะฟ + ะะธะฝะฐะผะธัะตัะบะธะน ะบะพะฝััะฐะบั

### ะกะปะพะธ ะฐััะธัะตะบัััั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Application Layer               โ
โ   (LSP Server, CLI Tools, Extensions)   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Analysis Layer                  โ
โ   (Parser, Type Checker, Query Analyzer)โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Resolution Layer                โ
โ   (Type Resolver, Context Resolver)     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ           Core Layer                    โ
โ   (Types, Facets, Contracts)           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Adapter Layer                   โ
โ   (Platform Docs, Config Parser)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะพัะพะถะฝะฐั ะบะฐััะฐ ัะฐะทัะฐะฑะพัะบะธ

### โ Phase 1: MVP (ะะฐะฒะตััะตะฝะฐ)
- [x] ะะฐะทะพะฒะพะต ัะฐะทัะตัะตะฝะธะต ัะธะฟะพะฒ ั ััะพะฒะฝัะผะธ ัะฒะตัะตะฝะฝะพััะธ
- [x] ะะพะปะฝะฐั ัะฐัะตัะฝะฐั ัะธััะตะผะฐ (Manager, Object, Reference, Constructor)
- [x] ะัะฝะพะฒะฝัะต ััััะบัััั ะดะฐะฝะฝัั ะธ ะฐะฑัััะฐะบัะธะธ
- [x] ะะฐะณััะทะบะฐ ะฟะปะฐััะพัะผะตะฝะฝัั ัะธะฟะพะฒ (ัะฐัะดะบะพะด ั TODO)
- [x] ะะฐััะธะฝะณ Configuration.xml ั ัะฐะฑะปะธัะฝัะผะธ ัะฐัััะผะธ
- [x] LSP ัะตัะฒะตั ั hover ะธ completion
- [x] ะะตะฝะตัะฐัะธั runtime ะบะพะฝััะฐะบัะพะฒ

### โ Phase 2: ะะฝะฐะปะธะท ะบะพะดะฐ (ะะฐะฒะตััะตะฝะฐ)
- [x] BSL ะฟะฐััะตั ะฝะฐ ะพัะฝะพะฒะต nom combinators
- [x] ะะตะฝะตัะฐัะธั AST (Abstract Syntax Tree)
- [x] Visitor pattern ะดะปั ะพะฑัะพะดะฐ AST
- [x] ะัะฐั ะทะฐะฒะธัะธะผะพััะตะน ัะธะฟะพะฒ ั ะพะฑะฝะฐััะถะตะฝะธะตะผ ัะธะบะปะพะฒ
- [x] Type checker ั ะฒัะฒะพะดะพะผ ัะธะฟะพะฒ
- [x] ะัะพะฒะตัะบะฐ ัะพะฒะผะตััะธะผะพััะธ ัะธะฟะพะฒ
- [x] ะะธะฐะณะฝะพััะธะบะธ ะฒ LSP (ะพัะธะฑะบะธ, ะฟัะตะดัะฟัะตะถะดะตะฝะธั)
- [x] ะะพะฝัะตะบััะฝะพ-ะทะฐะฒะธัะธะผะพะต ัะฐะทัะตัะตะฝะธะต ัะธะฟะพะฒ

### โ Phase 3: ะะพะดะดะตัะถะบะฐ ะทะฐะฟัะพัะพะฒ (ะะฐะฒะตััะตะฝะฐ)
- [x] ะะฐััะตั ัะทัะบะฐ ะทะฐะฟัะพัะพะฒ 1ะก
- [x] ะะพะดะดะตัะถะบะฐ ัะพััะฐะฒะฝัั ะธะผัะฝ ัะฐะฑะปะธั (ะะพะบัะผะตะฝั.ะะพัััะฟะปะตะฝะธะตะขะพะฒะฐัะพะฒะฃัะปัะณ)
- [x] ะัะตะผะตะฝะฝัะต ัะฐะฑะปะธัั (ะะะะะกะขะะขะฌ/ะะ ะะข_)
- [x] ะะฐะบะตัะฝัะต ะทะฐะฟัะพัั ั ะฐะฝะฐะปะธะทะพะผ ะทะฐะฒะธัะธะผะพััะตะน
- [x] JOIN ะพะฟะตัะฐัะธะธ (ะะะะะ/ะะะะะะ/ะะะะะะ/ะะะฃะขะะะะะะ ะกะะะะะะะะะ)
- [x] ะะณัะตะณะฐัะฝัะต ััะฝะบัะธะธ ะธ GROUP BY
- [x] ะะพะดะทะฐะฟัะพัั ะธ UNION
- [x] ะะฝัะตะณัะฐัะธั ั ัะธััะตะผะพะน ัะธะฟะพะฒ

### ๐ง Phase 3.5: ะะฐััะตั ัะธะฝัะฐะบั-ะฟะพะผะพัะฝะธะบะฐ (ะ ัะฐะทัะฐะฑะพัะบะต)
- [ ] ะะฐััะตั XML ัะฐะนะปะพะฒ ัะธะฝัะฐะบั-ะฟะพะผะพัะฝะธะบะฐ
- [ ] ะะทะฒะปะตัะตะฝะธะต ะณะปะพะฑะฐะปัะฝัั ััะฝะบัะธะน ะธ ะธั ัะธะณะฝะฐััั
- [ ] ะะฐััะธะฝะณ ะผะตัะพะดะพะฒ ะพะฑัะตะบัะพะฒ ะฟะปะฐััะพัะผั
- [ ] ะกะธััะตะผะฝัะต ะฟะตัะตัะธัะปะตะฝะธั ะธ ะบะพะฝััะฐะฝัั
- [ ] ะะฝัะตะณัะฐัะธั ั PlatformTypeResolver
- [ ] ะะตัะธัะพะฒะฐะฝะธะต ัะฐัะฟะฐััะตะฝะฝัั ะดะฐะฝะฝัั

### ๐ Phase 4: ะะฐััะธัะตะฝะฝัะน ะฐะฝะฐะปะธะท (ะะฐะฟะปะฐะฝะธัะพะฒะฐะฝะพ)
- [ ] Flow-sensitive ะฐะฝะฐะปะธะท ัะธะฟะพะฒ
- [ ] ะะตะถะฟัะพัะตะดััะฝัะน ะฐะฝะฐะปะธะท
- [ ] Type narrowing ะฒ ััะปะพะฒะธัั
- [ ] ะะฑะฝะฐััะถะตะฝะธะต ะผัััะฒะพะณะพ ะบะพะดะฐ
- [ ] ะะฟัะธะผะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ

### Phase 5: ะะฝัะตะณัะฐัะธั ั ะฟะปะฐััะพัะผะพะน
- [ ] ะะฐััะตั ะดะพะบัะผะตะฝัะฐัะธะธ ะฟะปะฐััะพัะผั
- [ ] ะะตะฐะปัะฝัะต ัะธะฟั ะฟะปะฐััะพัะผั ะธะท ITS/HTML ะดะพะบัะผะตะฝัะฐัะธะธ
- [ ] ะะฝะดะตะบัะฐัะธั ะผะตัะฐะดะฐะฝะฝัั ะบะพะฝัะธะณััะฐัะธะธ
- [ ] ะะตะถะผะพะดัะปัะฝะพะต ะพััะปะตะถะธะฒะฐะฝะธะต ัะธะฟะพะฒ

### Phase 6: ะะฟัะธะผะธะทะฐัะธั ะธ ML
- [ ] ะะฝะบัะตะผะตะฝัะฐะปัะฝัะน ะฐะฝะฐะปะธะท
- [ ] ะะฐัะฐะปะปะตะปัะฝะฐั ะฟัะพะฒะตัะบะฐ ัะธะฟะพะฒ
- [ ] ML-based ะฟัะตะดัะบะฐะทะฐะฝะธั ัะธะฟะพะฒ
- [ ] ะะฝััััะผะตะฝัั ะฟัะพัะธะปะธัะพะฒะฐะฝะธั

## ๐๏ธ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
bsl-gradual-types/
โโโ src/
โ   โโโ core/                    # ะฏะดัะพ ัะธััะตะผั ัะธะฟะพะฒ
โ   โ   โโโ types.rs            # ะะฟัะตะดะตะปะตะฝะธั ัะธะฟะพะฒ ะธ ัะฐะทัะตัะตะฝะธะต
โ   โ   โโโ resolution.rs       # Pipeline ัะฐะทัะตัะตะฝะธั ัะธะฟะพะฒ
โ   โ   โโโ contracts.rs        # ะะตะฝะตัะฐัะธั runtime ะบะพะฝััะฐะบัะพะฒ
โ   โ   โโโ facets.rs           # ะคะฐัะตัะฝะฐั ัะธััะตะผะฐ
โ   โ   โโโ context.rs          # ะะพะฝัะตะบััะฝะพ-ะทะฐะฒะธัะธะผะพะต ัะฐะทัะตัะตะฝะธะต
โ   โ   โโโ dependency_graph.rs # ะัะฐั ะทะฐะฒะธัะธะผะพััะตะน ัะธะฟะพะฒ
โ   โ   โโโ type_checker.rs     # ะัะพะฒะตัะบะฐ ะธ ะฒัะฒะพะด ัะธะฟะพะฒ
โ   โ   โโโ standard_types.rs   # ะกัะฐะฝะดะฐััะฝัะต ัะธะฟั BSL
โ   โโโ parser/                  # BSL ะฟะฐััะตั
โ   โ   โโโ lexer.rs            # ะขะพะบะตะฝะธะทะฐัะธั
โ   โ   โโโ parser.rs           # ะกะธะฝัะฐะบัะธัะตัะบะธะน ะฐะฝะฐะปะธะท (nom)
โ   โ   โโโ ast.rs              # Abstract Syntax Tree
โ   โ   โโโ visitor.rs          # Visitor pattern ะดะปั AST
โ   โ   โโโ graph_builder.rs    # ะะพัััะพะตะฝะธะต ะณัะฐัะฐ ะทะฐะฒะธัะธะผะพััะตะน
โ   โโโ query/                   # ะะฐััะตั ะทะฐะฟัะพัะพะฒ 1ะก
โ   โ   โโโ parser.rs           # ะะฐััะตั ัะทัะบะฐ ะทะฐะฟัะพัะพะฒ
โ   โ   โโโ ast.rs              # AST ะดะปั ะทะฐะฟัะพัะพะฒ
โ   โ   โโโ batch.rs            # ะะฐะบะตัะฝัะต ะทะฐะฟัะพัั
โ   โ   โโโ type_checker.rs     # ะัะพะฒะตัะบะฐ ัะธะฟะพะฒ ะฒ ะทะฐะฟัะพัะฐั
โ   โโโ adapters/                # ะะดะฐะฟัะตัั ะฒะฝะตัะฝะธั ะดะฐะฝะฝัั
โ   โ   โโโ config_parser_xml.rs # ะะฐััะตั Configuration.xml
โ   โ   โโโ platform_docs.rs    # ะะฐััะตั ะดะพะบัะผะตะฝัะฐัะธะธ ะฟะปะฐััะพัะผั
โ   โโโ bin/                     # ะัะฟะพะปะฝัะตะผัะต ัะฐะนะปั
โ       โโโ analyzer.rs          # CLI ะฐะฝะฐะปะธะทะฐัะพั
โ       โโโ lsp_server.rs        # Language Server Protocol
โ       โโโ build_index.rs       # ะะพัััะพะธัะตะปั ะธะฝะดะตะบัะฐ ัะธะฟะพะฒ
โ       โโโ type_check.rs        # CLI ะฟัะพะฒะตัะบะฐ ัะธะฟะพะฒ
โโโ tests/                       # ะขะตััั
โ   โโโ integration/            # ะะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
โ   โโโ fixtures/               # ะขะตััะพะฒัะต ะดะฐะฝะฝัะต
โ       โโโ bsl/               # BSL ัะฐะนะปั
โ       โโโ xml/               # XML ะบะพะฝัะธะณััะฐัะธะธ
โ       โโโ queries/           # ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ
โโโ examples/                    # ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั
โ   โโโ query_demo.rs           # ะะตะผะพ ะฟะฐััะตัะฐ ะทะฐะฟัะพัะพะฒ
โ   โโโ queries/                # ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ 1ะก
โโโ docs/                        # ะะพะบัะผะตะฝัะฐัะธั
โ   โโโ ARCHITECTURE.md         # ะััะธัะตะบัััะฐ ัะธััะตะผั
โ   โโโ MIGRATION_PLAN.md       # ะะปะฐะฝ ะผะธะณัะฐัะธะธ
โ   โโโ TEST_STRUCTURE.md       # ะกัััะบัััะฐ ัะตััะพะฒ
โโโ CLAUDE.md                    # ะะพะฝัะตะบัั ะดะปั Claude AI

```

## ๐ ะะพะบัะผะตะฝัะฐัะธั

ะะตัะฐะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฒ ะดะธัะตะบัะพัะธะธ `docs/`:

- [ะััะธัะตะบัััะฐ ัะธััะตะผั](docs/ARCHITECTURE.md)
- [ะะปะฐะฝ ะผะธะณัะฐัะธะธ](docs/MIGRATION_PLAN.md)
- [ะกัััะบัััะฐ ัะตััะพะฒ](TEST_STRUCTURE.md)
- [ะััะพัะธั ะธะทะผะตะฝะตะฝะธะน](CHANGELOG.md)

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

```bash
# ะัะต ัะตััั
cargo test

# ะขะพะปัะบะพ ะธะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
cargo test --test "*"

# ะะพะฝะบัะตัะฝัะน ัะตัั
cargo test --test query_parser_test

# ะก ะฒัะฒะพะดะพะผ ะพัะปะฐะดะพัะฝะพะน ะธะฝัะพัะผะฐัะธะธ
cargo test -- --nocapture
```

## ๐ค ะฃัะฐััะธะต ะฒ ัะฐะทัะฐะฑะพัะบะต

ะัะพะตะบั ะฝะฐัะพะดะธััั ะฒ ะฐะบัะธะฒะฝะพะน ัะฐะทัะฐะฑะพัะบะต. ะัะธะฒะตัััะฒััััั ะบะพะฝััะธะฑััะธะธ!

### ะัะธะฝัะธะฟั ัะฐะทัะฐะฑะพัะบะธ

1. **ะงะตััะฝะฐั ะฝะตะพะฟัะตะดะตะปัะฝะฝะพััั** - TypeResolution::Unknown ะปัััะต ะฝะตะฟัะฐะฒะธะปัะฝะพะณะพ Inferred
2. **ะญะฒะพะปััะธะพะฝะฝะพััั** - ะะฐะถะดะฐั ัะฐะทะฐ ะดะฐัั ัะฐะฑะพัะฐััะธะน ััะฝะบัะธะพะฝะฐะป
3. **ะะพะดัะปัะฝะพััั** - ะะพะฒัะต ะฐะฝะฐะปะธะทะฐัะพัั ะดะพะฑะฐะฒะปััััั ัะตัะตะท traits
4. **ะัะฐะดัะฐะปัะฝะพััั** - ะะฐัะธะฝะฐะตะผ ัะพ ััะฐัะธะบะธ, ะดะพะฑะฐะฒะปัะตะผ ะดะธะฝะฐะผะธะบั ะณะดะต ะฝัะถะฝะพ

## ๐ ะะธัะตะฝะทะธั

MIT License - ัะผ. ัะฐะนะป [LICENSE](LICENSE)

## ๐ ะกะฒัะทะฐะฝะฝัะต ะฟัะพะตะบัั

- [bsl_type_safety_analyzer](https://github.com/yourusername/bsl_type_safety_analyzer) - ะัะตะดัะดััะฐั ะธัะตัะฐัะธั
- [1c-syntax](https://github.com/1c-syntax) - ะะฝััััะผะตะฝัั ะดะปั BSL

## ๐ ะกัะฐััั

**ะขะตะบััะฐั ะฒะตััะธั**: 0.3.0  
**ะขะตะบััะฐั ัะฐะทะฐ**: Phase 3.5 - ะะฐััะตั ัะธะฝัะฐะบั-ะฟะพะผะพัะฝะธะบะฐ (ะฒ ัะฐะทัะฐะฑะพัะบะต)  
**ะกัะฐััั**: ะะบัะธะฒะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ  
**ะะพะดะดะตัะถะบะฐ ะฟะปะฐััะพัะผั**: 1ะก:ะัะตะดะฟัะธััะธะต 8.3.20+

### ะะพัะปะตะดะฝะธะต ะดะพััะธะถะตะฝะธั
- โ ะะพะปะฝัะน ะฟะฐััะตั BSL ั ะฟะพะดะดะตัะถะบะพะน ะฒัะตะณะพ ัะธะฝัะฐะบัะธัะฐ
- โ ะะฐััะตั ัะทัะบะฐ ะทะฐะฟัะพัะพะฒ 1ะก ั ะฒัะตะผะตะฝะฝัะผะธ ัะฐะฑะปะธัะฐะผะธ
- โ ะะฒะธะถะพะบ ะฒัะฒะพะดะฐ ัะธะฟะพะฒ ั ััะพะฒะฝัะผะธ ัะฒะตัะตะฝะฝะพััะธ
- โ ะัะฐั ะทะฐะฒะธัะธะผะพััะตะน ะดะปั ะฐะฝะฐะปะธะทะฐ ะฟะพัะพะบะฐ ัะธะฟะพะฒ
- โ LSP ัะตัะฒะตั ั ะดะธะฐะณะฝะพััะธะบะพะน ะธ ะฐะฒัะพะดะพะฟะพะปะฝะตะฝะธะตะผ
- โ ะะฐะบะตัะฝัะต ะทะฐะฟัะพัั ั ะฐะฝะฐะปะธะทะพะผ ะทะฐะฒะธัะธะผะพััะตะน
- โ ะะตะฝะตัะฐัะธั runtime ะบะพะฝััะฐะบัะพะฒ ะดะปั ะณัะฐะดัะฐะปัะฝะพะน ัะธะฟะธะทะฐัะธะธ

### ะะตััะธะบะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- ะะฐะณััะทะบะฐ ะบะพะฝัะธะณััะฐัะธะธ ั 1000+ ะพะฑัะตะบัะฐะผะธ: < 1 ัะตะบ
- ะัะฒะตั LSP ะฝะฐ ะฐะฒัะพะดะพะฟะพะปะฝะตะฝะธะต: < 100ms
- ะะฐััะธะฝะณ BSL ัะฐะนะปะฐ 10000 ัััะพะบ: < 500ms
- ะะฝะฐะปะธะท ะฟะฐะบะตัะฐ ะธะท 10 ะทะฐะฟัะพัะพะฒ: < 50ms