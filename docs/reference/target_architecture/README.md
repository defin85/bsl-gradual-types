# Целевая архитектура BSL Gradual Type System

Документация по «целевой» (практичной) архитектуре, ранее называлась «революционной». Здесь собран приземлённый план перехода к слоистой архитектуре без пафоса и с упором на постепенную интеграцию.

## Зачем
- Упростить эволюцию проекта до чёткой слоистой модели Data → Domain → Application → Presentation.
- Свести данные о типах к единому хранилищу и обеспечить один сервис разрешения типов.
- Дать LSP/Web/CLI стабильные интерфейсы, не зависящие от реализации внутри.

## Статус
- Формат: Концепт + рабочий план
- Ориентир: реализуется итеративно, совместно с текущим кодом

### Статус миграции (обновление v0.4.x)
- Legacy‑движок удалён; все компоненты работают в target‑режиме.
- Центральная система (`CentralTypeSystem`) подключена и инициализирует слои Data → Domain → Application → Presentation.
- Data Layer: InMemory `TypeRepository` с `save/load/search/filters` и корректной статистикой по источникам.
- Domain Layer: базовые резолверы (Platform, Builtin, минимальный Expression), каркас BSL/tree‑sitter; минимальный `TypeCheckerService`.
- Application/Presentation: LSP‑проксирование hover/completion через `LspInterface`; Web – поисковые ручки `/api/types` и детали `/api/types/{name}` в target‑режиме через `WebInterface`; CLI – базовая интеграция.
- Метрики: агрегируются метрики LSP; статус системы доступен на `GET /api/health` (target).

В ближайших итерациях:
- Расширение метрик домена (total_resolutions, avg_resolution_time) и проброс в `SystemMetrics`.
- Укрепление `ExpressionResolver` и покрытие конфигурационных типов.
- Интеграция `TypeCheckerService` в diagnostics (LSP/Web/CLI).
- Тесты: unit для резолверов и интеграционные для инициализации/ручек.

## С чего начать
1. Прочесть «Обзор» — `overview.md`
2. Посмотреть API центральной системы — `central_type_system.md`
3. Свериться с дорожной картой — `roadmap.md`
4. Изучить миграцию по шагам — `migration_plan.md`

## Состав
- `overview.md` — обзор слоёв и ключевых компонентов
- `central_type_system.md` — контракт и ответственность центральной системы
- `roadmap.md` — фазы внедрения с разбивкой на задачи
- `migration_plan.md` — стратегия перехода без ломки текущего кода

## Исторические документы
Исторические документы из раздела architecture удалены; актуальная информация — в этом разделе.

